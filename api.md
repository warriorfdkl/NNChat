Работа с API начинается со входа в систему:

Сущность

Операции доступные через API

REST API

Вход в систему

Получение токена

URL: api/security/login
Метод: POST
Описание: Авторизация
Входные параметры:
json объект

{

  "login": "логин",

  "password": "пароль"

}
Ответ: токен пользователя

(Токен пользователя передается в заголовке Authorization)

Пример:

Получить токен авторизации

Пример запроса
Пример ответа
Все элементы



Чтение метаданных

URL: api/item/get/{itemId}
Метод: POST
Описание: получить информацию об элементе по ID элемента
Входные параметры:
itemId: Guid - ID элемента списка
Выходные параметры:
json объект:

{
    id: Guid -  ID элемента
    siteId: Guid -  ID сайта
    listId: Guid -  ID списка
    parentId: Guid -  ID родительского элемента
    itemPath: ItemPath -  путь до элемента + количество дочерних элементов
    сontentTypeId - ID типа контента элемента
    fieldValueMap - объект ключ-значение. Ключ - internalName поля, значение - значение этого поля в элементе
}

Пример:

Получить метаданные элемента с id 6ecc311f-7df7-441d-8618-534392e9d31b

Пример запроса
Пример ответа
Создание/изменение

URL: api/item/update
Метод: POST
Описание: Создать/обновить элемент списка (или массив элементов)
Входные параметры:
multipart/form-data

itemListJson - строка, сериализованный в json массив элементов ItemUpdateRequest

{
    list_id: Guid - ID списка, элемент которого нужно создать (обязательное)
    content_type_id: Guid - ID типа контента элемента (обязательное при создании элемента).
    parent_id: Guid - ID родительского элемента.
   ...поля типа контента элемента, которые нужно изменить, например:
    name: "новое имя"
}



Правила передачи значений
1. Если поле является лукапом, то нужно передать строку с уникальным идентификатором нового значения. Пример:
"document_status":"583ba97b-4688-41cc-a21a-9e4d3f6794b1"
2. Если поле является множественным лукапом, то нужно передать массив строк - уникальных идентификаторов. Пример:
"approval_workflow_initiator":["aab39600-92b4-4c38-a55c-53efac8db9cc","3a9a648b-98a0-43e2-b5bf-b06d0084303a"]
3. Если поле является датой, то нужно передать строку в формате ISO 8601 в UTC. Пример:
"end_date_plan":"2024-01-28T08:40:26.168Z"
4. Если поле является числом, то нужно передать число:
"duration_plan":3
5. Если поле является строкой, то нужно передать строку. Пример:
"name":"План.pdf"

Пример:

Изменить статус элемента (документа) с id 6ecc311f-7df7-441d-8618-534392e9d31b

Пример запроса
Пример ответа
Удаление



URL: api/item/delete
Метод: POST
Описание: Удалить элемент (массив элементов)
Входные параметры:
itemListJson - строка, сериализованный в json массив элементов

[
    {
        id : Guid - ID первого удаляемого элемента
    },
    {
        id : Guid - ID второго  удаляемого элемента
    },
    ...
]



Примечание: при вызове данного метода элемент перемещается в корзину и может быть восстановлен методом описанным ниже. Для удаления элемента без возможности восстановления требуется вызвать данный метод повторно. 

Пример:

Удалить элемент с id b128f641-7169-419f-b84f-99fc34b51aff



Пример запроса
Пример ответа
Восстановление из корзины

URL: api/item/restore/{itemId}
Метод: POST
Описание: восстановить ранее удаленный в корзину элемент
Входные параметры:
itemId: Guid - ID элемента списка

Пример:

Восстановить элемент с id b128f641-7169-419f-b84f-99fc34b51aff

Пример запроса
Пример ответа
Установить уникальные права доступа к элементу

URL: api/security/setItemUniquePermission/
Метод: POST

Описание: Прервать наследование прав/ установить уникальные права доступа к элементу

Входные параметры:

Входные параметры:
{
        id : Guid - ID элемента,

       copy_permission: bool (требуется ли скопировать и установить прежние разрешения на элемент)

}

Пример:

Установить уникальные права доступа для элемента с id b128f641-7169-419f-b84f-99fc34b51aff

Пример запроса
Пример ответа
Удалить уникальные права доступа к элементу

URL: api/security/removeItemUniquePermission/{itemId}
Метод: POST

Описание: Восстановить наследование прав/ Удалить уникальные права доступа к элементу

Входные параметры:
itemId - ID элемента

Пример:

Удалить уникальные права доступа для элемента с id b128f641-7169-419f-b84f-99fc34b51aff

Пример запроса
Пример ответа
Назначение прав доступа к элементу пользователю или группе

URL: api/item/update
Метод: POST
Описание: Задать права пользователю на элемент с уникальными правами. Задание прав происходит путем создания элемента «Разрешение пользователя» в списке «Разрывы прав».
Входные параметры:
multipart/form-data

  itemListJson - строка, сериализованный в json массив элементов ItemUpdateRequest


{

  list_id: Guid -  ID списка «Разрывы прав» (обязательное) ,

  content_type_id: Guid – ID типа элемента «Разрешение пользователя» (обязательное),

  source: Guid -  ID элемента, для которого задаются права (обязательное),

  principal: Guid -  ID пользователя или группы (обязательное),

  permission_level: Guid -  ID уровня доступа (обязательное)

}

Пример:

Установить уровень доступа "Изменить" (id 9d29f390-70d9-4598-816a-68035a0d6d9f) для пользователя с id ba2bdc08-f633-5666-94f7-a91901fdf3da к папке с id b128f641-7169-419f-b84f-99fc34b51aff

Пример запроса
Пример ответа
Получить список прав текущего пользователя на элемент

URL: api/security/getItemPermissionList/{itemId}
Метод: POST

Описание: Получить список элементарных прав пользователя на заданный элемент

Входные параметры:

itemId - ID элемента

Пример:

Получить список прав текущего пользователя на элемент с id 2bf2db08-c99d-716f-8cee-7028ebb8afe9

Пример запроса
Пример ответа
Списки

Чтение метаданных

URL: api/list/get/{listId}

Метод: POST

Описание: получить информацию о списке по ID списка

Входные параметры:

listId: Guid - ID списка

Выходные параметры:

json объект

List

{

    id: Guid -  ID списка

    name: string - Название списка

    description: string  - описание списка

}

Пример:

Получить метаданные списка "Пользователи" (id e3a94bde-0ca9-456f-b338-4465d40389ee) 

Пример запроса
Пример ответа
Элементы списка



URL: api/item/getList/{parentId}
Метод: POST
Описание: получить информацию о всех дочерних элементах по ID родительского элемента
Входные параметры:
parentId - ID родительского элемента (ID списка или ID папки внутри списка)
Выходные параметры:
json объект

Пример:

Получить данные об элементах списка "Пользователи" (id e3a94bde-0ca9-456f-b338-4465d40389ee) 

Пример запроса
Пример ответа
URL: api/item/getRecursive/{parentId}
Метод: POST
Описание: рекурсивно получить информацию о всех дочерних элементах по ID родительского элемента (дочерние элементы + их дочерние элементы и т.д.)
Входные параметры:
parentId - ID родительского элемента (ID списка или ID папки внутри списка)
Выходные параметры:
json объект

Пример:

Получить список всех дочерних элементов для папки с id 4a862423-20fe-4798-b013-1ea0471d6552 и их дочерних элементов

Пример запроса
Пример ответа
URL: api/lookup/GetList/{fieldId}
Метод: POST
Описание: получить информацию об элементах списка на который ссылается lookup-атрибут по ID  этого атрибута
Входные параметры:
fieldId - ID lookup-атрибута
Выходные параметры:
json объект

Пример:

Получить перечень элементов списка на который ссылается атрибут "Важность" (id атрибута 8abf69f6-52fd-46b3-b6e3-f2b3af46d151)

Пример запроса
Пример ответа
Типы элементов списка

URL: api/contenttype/getByList/{listId}

Метод: POST

Описание: получить информацию о типах контента списка по ID списка

Входные параметры:

listId: Guid - ID списка

Выходные параметры:

json объект

ContentType[] - массив типов контента списка

ContentType

{

    id: Guid -  ID типа контента

    name: string - Название типа контента

    description: string  - описание типа контента

    isFolder: boolean - могут ли элементы этого типа контента содержать в себе дочерние элементы

    fieldList: Field[] - массив полей, которые привязаны к типу контента

}

Пример:

Получить типы элементов списка "Пользователи" (id e3a94bde-0ca9-456f-b338-4465d40389ee)

Пример запроса
Пример ответа
Папки / элементы

Перемещение

URL: api/item/move/{itemId}/{toItemId}/{moveItemType}
Метод: POST
Описание: Переместить элемент
Входные параметры:

itemId - ID перемещаемого элемента
toItemId - ID элемента назначения
moveItemType - тип перемещения:
1 - выше элемента назначения
2 - в конец дочерних элементов элемента назначения
3 - ниже элемента назначения



Пример:

Переместить папку с id b128f641-7169-419f-b84f-99fc34b51aff в папку с id 4a862423-20fe-4798-b013-1ea0471d6552

Пример запроса
Пример ответа


Копирование

URL: api/item/copy/{toItemId}
Метод: POST
Описание: Скопировать элементы

Входные параметры:

toItemId - ID родительского элемента, в который выполняется копирование.
Тело запроса: json объект, массив элементов, которые нужно скопировать:

[
 
    {
        "id": "id первого элемента, который нужно скопировать",
        "isChildListCopyRequired": true/false нужно ли копировать дочерние элементы
    },
    {
        "id": "id второго элемента, который нужно скопировать",
        "isChildListCopyRequired": true/false нужно ли копировать дочерние элементы
    },
    ...
]




Пример:
Скопировать папку с ID 1cdc3a56-a733-4b19-b8a0-c1cbfd6fdfdb и все ее дочерние элементы внутрь папки c ID 2153dc08-2630-ea0c-acb3-daeb5db6e595
Пример запроса
2. Скопировать элемент с ID 1cdc3a56-a733-4b19-b8a0-c1cbfd6fdfdb без дочерних элементов внутрь папки c ID 2153dc08-2630-ea0c-acb3-daeb5db6e595

Пример запроса
Файлы



Создание

URL: api/item/update
Метод: POST
Описание: Создать/обновить элемент списка (или массив элементов)
Входные параметры:
multipart/form-data

    itemListJson - строка, сериализованный в json массив элементов ItemUpdateRequest
    fileList - двоичные данные - массив файлов (экземпляр File)

{
    id: Guid -  ID обновляемого элемента. Если создается новый элемент, то это поле не указывается (не обязательное)
    list_id: Guid - ID списка, элемент которого нужно обновить (обязательное)
    content_type_id: Guid - ID типа контента элемента. Указывается только при создании или при изменении типа контента существующего элемента (не обязательное)
    parent_id: Guid - ID типа родительского элемента. Указывается только при создании или при изменении родителя существующего элемента (не обязательное)
    file: int - ID тела файла, индекс из массива fileList . Указывается только при добавлении тела файла или при изменении тела существующего файла (не обязательное)
   ...поля типа контента элемента, которые нужно изменить, например:
    name: "новое имя"
}

Пример:

Загрузить файл список "Файлы" (id: 966e62c5-a803-49a0-a1be-e680d130c481) в папку с id 0b19b8bb-db6c-4057-9fdd-b79c2a0262e4

Пример запроса
Пример ответа
Получить список версий файла

URL: api/fileversion/get/{sourceId}

Метод: GET

Описание: получить список версий файла по ID файла

Входные параметры:

sourceId: Guid - ID элемента/файла

Выходные параметры:

массив – список версий файла

Пример:

Получить список версий файла с id 5bca4c6f-b7f6-47c8-974a-62d1622faf7e

Пример запроса
Пример ответа
Скачивание файла

URL: api/file/getbyitemid/{itemId}/{version}
Метод: GET
Описание: получить файл по ID элемента/файла
Входные параметры:
itemId: Guid - ID элемента/файла

version: имя версии файла (0.1, 1.0, 1.1, …)
Выходные параметры: тело файла с добавленным номером версии в конуе имени файла.

Пример:

Скачать версию 0.1 файла с id 7efc4818-5e79-41ea-86d8-cf9bbcb3269c

Пример запроса
Пример ответа
Бизнес-процессы

Создание бизнес-процесса

URL: api/item/update
Метод: POST
Описание: Создать/обновить бизнес-процесс
Входные параметры:
multipart/form-data



itemListJson - строка, сериализованный в json массив элементов ItemUpdateRequest



{

  list_id: Guid – ID списка «Процессы»,

  content_type_id: Guid – ID типа элемента запускаемого процесса,

  name: Наименование создаваемого процесса,

  start_date_plan:дата и время запуска процесса в формате "YYYY-MM-DDThh:mm:ss[.f{1,7}]<TZDSuffix>",

  importance: Guid – ID уровня важности процесса из списка «Важность»,

  workflow_template: Guid – ID шаблона проесса из списка «Шаблоны процессов»,

  ...

  … (поля типа контента процесса, которые нужно изменить),

  reference_list: список вложений рабочего процесса

  [

    {

      content_type_id: Guid – ID типа элемента «Вложение рабочего процесса» из списка «Типы контента»,

      destination: Guid – ID элемента, вкладываемого в процесс

    },

  ]

}

Пример:

Создать бизнес-процесс согласования (id типа процесса b3d71386-28c7-4e13-aab8-f11a65d69dd6)  с одним этапом, в качестве исполнителя указать едиснтвенного пользователя с id aab39600-92b4-4c38-a55c-53efac8db9cc, продолжительность этапа задать в 1 час, вложение в процесс - документс id 56fc1764-06ef-4bbc-ada2-88d16b4aa736

Пример запроса
Пример ответа
Запуск бизнес-процесса

URL: workflow/api/workflow/start/{processId}

Метод: POST
Описание: Запустить бизнес-процесс

Входные параметры:


processId - Guid – ID запускаемого процесса

Пример:

Запустить созданный в предыдущем примере процесс с id bf9ffbae-f773-4f63-af15-38b17036ec36

Пример запроса
Пример ответа
Связи

Получить список связей элемента

URL: api/reference/ getByDestination/{itemId}
Метод: POST
Описание: Получить список связей элемента по id элемента и id типа связи.
Входные параметры:
itemId: Guid - ID элемента

Json:

Список id типов связей, которые надо получить

[“referenceTypeId1”, “referenceTypeId2”]

Пример:

Получить список замечаний (id типа связи 4bc42916-9e3c-4c96-a25d-8a1b9b4bbc35) к файлу с id 4922dc08-bb93-ec14-a0a9-eae1ebf177bb

Пример запроса
Пример ответа
Пользователи

Задать/изменить пароль пользователя

URL: api/security/setPassword
Метод: POST
Описание: Задать/изменить пароль пользователя (требуются права админа).
Входные параметры:

json объект

{

  "principal": id пользователя, для которого надо задать пароль,

  "password": новый пароль пользователя,

  "is_change_password_at_next_login": bool, требовать ли смену пароля при следующем входе в систему,

  "is_two_factor_authentication_enabled":  bool, включить двухфакторную авторизацию

}

Пример: 

Установить пароль для пользователя с id ba3bdc08-f633-5666-94f7-a91901fdf3da

Пример запроса
Пример ответа